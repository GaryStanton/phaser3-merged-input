!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("MergedInput",[],t):"object"==typeof exports?exports.MergedInput=t():e.MergedInput=t()}(window,function(){return n={},r.m=i=[function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=p(i(1)),o=p(i(2));function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(y,Phaser.Plugins.ScenePlugin),r(y,[{key:"boot",value:function(){var e=this;if(this.eventEmitter=this.systems.events,this.game.events.on(Phaser.Core.Events.PRE_STEP,this.preupdate,this),this.game.events.on(Phaser.Core.Events.POST_STEP,this.postupdate,this),this.game.events.on(Phaser.Core.Events.BLUR,function(){e.loseFocus()}),void 0!==this.systems.input.gamepad){if(this.systems.input.gamepad.on("connected",function(e){this.refreshGamepads(),this.setupGamepad(e)},this),this.systems.input.gamepad.refreshPads(),this.systems.input.gamepad.total){this.refreshGamepads();var t=!0,i=!1,n=void 0;try{for(var r,a=this.gamepads[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;this.systems.input.gamepad.emit("connected",s)}}catch(e){i=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}}this.systems.input.gamepad.on("down",this.gamepadButtonDown,this),this.systems.input.gamepad.on("up",this.gamepadButtonUp,this)}this.systems.input.keyboard.on("keydown",this.keyboardKeyDown,this),this.systems.input.keyboard.on("keyup",this.keyboardKeyUp,this),this.systems.input.mouse.disableContextMenu()}},{key:"preupdate",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r=this.players[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a=n.value;a.pointer.BEARING=void 0!==a.pointer.BEARING?a.pointer.BEARING:"",a.pointer.BEARING_DEGREES=void 0!==a.pointer.BEARING_DEGREES?a.pointer.BEARING_DEGREES:0,a.pointer.ANGLE=void 0!==a.pointer.ANGLE?a.pointer.ANGLE:"",a.direction.BEARING=this.mapDirectionsToBearing(a.direction),a.direction.BEARING_LAST=""!=a.direction.BEARING?a.direction.BEARING:a.direction.BEARING_LAST,a.direction.DEGREES=""!=a.direction.BEARING?parseFloat(this.mapBearingToDegrees(a.direction.BEARING)):0,a.direction.DEGREES_LAST=""!=a.direction.BEARING_LAST?parseFloat(this.mapBearingToDegrees(a.direction.BEARING_LAST)):0,a.direction_secondary.BEARING=this.mapDirectionsToBearing(a.direction_secondary),a.direction_secondary.BEARING_LAST=""!=a.direction_secondary.BEARING?a.direction_secondary.BEARING:a.direction_secondary.BEARING_LAST,a.direction_secondary.DEGREES=""!=a.direction_secondary.BEARING?parseFloat(this.mapBearingToDegrees(a.direction_secondary.BEARING)):0,a.direction_secondary.DEGREES_LAST=""!=a.direction_secondary.BEARING_LAST?parseFloat(this.mapBearingToDegrees(a.direction_secondary.BEARING_LAST)):0}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}this.checkKeyboardInput(),this.checkGamepadInput(),this.checkPointerInput()}},{key:"postupdate",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r=this.players[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a=n.value;this.clearBuffer(a)}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}}},{key:"clearBuffer",value:function(e){0<e.interaction.pressed.length&&0==e.internal.fakedpadPressed.length&&(e.interaction.buffer=[]),0==e.interaction.buffer.length&&(e.interaction.pressed=[],e.interaction_mapped.pressed=[],0==e.internal.fakedpadReleased.length&&(e.interaction.released=[],e.interaction_mapped.released=[])),e.internal.fakedpadPressed=[],e.internal.fakedpadReleased=[]}},{key:"loseFocus",value:function(){for(var e in this.keys)this.keys[e].reset()}},{key:"setupGamepad",value:function(e){this.eventEmitter.emit("mergedInput",{device:"gamepad",id:e.id,player:e.index,action:"Connected"}),void 0===this.players[e.index]&&this.addPlayer();var t=e.id.toLowerCase();this.players[e.index].gamepad=e;var i=this.controlManager.mapGamepad(t);for(var n in this.players[e.index].gamepadMapping=i.gamepadMapping,this.players[e.index].interaction_mapped.gamepadType=i.padType,this.players[e.index].gamepadMapping)this.players[e.index].buttons_mapped[n]=0}},{key:"refreshGamepads",value:function(){this.gamepads=this.systems.input.gamepad.gamepads.filter(function(e){return null!=e});var e=!0,t=!1,i=void 0;try{for(var n,r=this.gamepads.entries()[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a=d(n.value,2),s=a[0],o=a[1];o.index=s,o.fakedpad=o.buttons.length<15}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}}},{key:"addPlayer",value:function(e,t){if(t=t||16,n(Number.isInteger(e))&&void 0!==this.players[e])return this.players[e];var i=this.controlManager.setupControls(t);return this.addPlayerHelperFunctions(i),this.players.push(i),this.players[this.players.length-1].index=this.players.length-1,1==this.players.length&&(this.systems.input.on("pointermove",function(e){this.pointerMove(e)},this),this.systems.input.on("pointerdown",function(e){this.pointerDown(e)},this),this.systems.input.on("pointerup",function(e){this.pointerUp(e)},this)),this.players[this.players.length-1]}},{key:"addPlayerHelperFunctions",value:function(i){return i.interaction.isPressed=function(e){var t=(e="string"==typeof e?Array(e):e).filter(function(e){return i.interaction.pressed.includes(e)});return!!t.length&&t},i.interaction.isReleased=function(e){var t=(e="string"==typeof e?Array(e):e).filter(function(e){return i.interaction.released.includes(e)});return!!t.length&&t},i.interaction_mapped.isPressed=function(e){var t=(e="string"==typeof e?Array(e):e).filter(function(e){return i.interaction_mapped.pressed.includes(e)});return!!t.length&&t},i.interaction_mapped.isReleased=function(e){var t=(e="string"==typeof e?Array(e):e).filter(function(e){return i.interaction_mapped.released.includes(e)});return!!t.length&&t},this}},{key:"getPlayer",value:function(e){return void 0!==this.players[e]?this.players[e]:""}},{key:"getPlayerIndexFromKey",value:function(e){var t=!0,i=!1,n=void 0;try{for(var r,a=this.players[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;for(var o in s.keys){var d=!0,p=!1,l=void 0;try{for(var u,y=s.keys[o][Symbol.iterator]();!(d=(u=y.next()).done);d=!0)if(u.value==e)return s.index}catch(e){p=!0,l=e}finally{try{!d&&y.return&&y.return()}finally{if(p)throw l}}}}}catch(e){i=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}return-1}},{key:"getPlayerButtonFromKey",value:function(e){var t=!0,i=!1,n=void 0;try{for(var r,a=this.players[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;for(var o in s.keys){var d=!0,p=!1,l=void 0;try{for(var u,y=s.keys[o][Symbol.iterator]();!(d=(u=y.next()).done);d=!0)if(u.value==e)return void 0!==s.gamepadMapping[o]?"B"+s.gamepadMapping[o]:o}catch(e){p=!0,l=e}finally{try{!d&&y.return&&y.return()}finally{if(p)throw l}}}}}catch(e){i=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}return""}},{key:"getPlayerActions",value:function(e){var t=["UP","DOWN","LEFT","RIGHT","ALT_UP","ALT_DOWN","ALT_LEFT","ALT_RIGHT"];return t.push.apply(t,l(Object.keys(this.players[e].gamepadMapping))),t.push.apply(t,l(Object.keys(this.players[e].buttons))),t}},{key:"getMappedButton",value:function(t,i){return i=i.toString().replace(/\D/g,""),Object.keys(t.gamepadMapping).find(function(e){return t.gamepadMapping[e]==i})}},{key:"defineKey",value:function(e,t,i,n){var r=0<arguments.length&&void 0!==e?e:0,a=t,s=i,o=3<arguments.length&&void 0!==n&&n;return void 0===this.players[r]&&this.addPlayer(),this.getPlayerActions(r).includes(a)&&(o&&void 0!==this.players[r].keys[a]||(this.players[r].keys[a]=[]),this.players[r].keys[a].push([s]),this.keys[[s]]=this.systems.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes[s])),this}},{key:"checkKeyboardInput",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r=this.players[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a=n.value;for(var s in a.keys){var o=0,d=!0,p=!1,l=void 0;try{for(var u,y=a.keys[s][Symbol.iterator]();!(d=(u=y.next()).done);d=!0){var c=u.value;o=this.keys[c].isDown?1:o}}catch(e){p=!0,l=e}finally{try{!d&&y.return&&y.return()}finally{if(p)throw l}}["UP","DOWN","LEFT","RIGHT"].includes(s)?(a.direction[s]=o,a.direction.TIMESTAMP=this.scene.sys.time.now):["ALT_UP","ALT_DOWN","ALT_LEFT","ALT_RIGHT"].includes(s)?1==(a.direction_secondary[s.replace("ALT_","")]=o)&&(a.direction_secondary.TIMESTAMP=this.scene.sys.time.now):s in a.gamepadMapping?(a.buttons["B"+a.gamepadMapping[s]]=o,1==(a.buttons_mapped[s]=o)&&(a.buttons.TIMESTAMP=this.scene.sys.time.now)):1==(a.buttons[s]=o)&&(a.buttons.TIMESTAMP=this.scene.sys.time.now),1==o&&(a.interaction.device="keyboard")}}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}}},{key:"keyboardKeyDown",value:function(t){var e=Object.keys(Phaser.Input.Keyboard.KeyCodes).find(function(e){return Phaser.Input.Keyboard.KeyCodes[e]===t.keyCode}),i=this.getPlayerIndexFromKey(e),n=this.getPlayerButtonFromKey(e);if(-1<i&&""!=n){var r=this.getPlayer(i);if(this.eventEmitter.emit("mergedInput",{device:"keyboard",value:1,player:i,action:e,state:"DOWN"}),r.interaction.device="keyboard",r.interaction.pressed.push(n),r.interaction.buffer.push(n),r.interaction.last=n,r.interaction.lastPressed=n,void 0!==this.dpadMappings[n]&&(n="B"+this.dpadMappings[n]),void 0!==r.buttons[n]){var a=this.getMappedButton(r,n);void 0!==a&&(r.buttons_mapped[a]=1,r.interaction_mapped.pressed.push(a),r.interaction_mapped.last=a,r.interaction_mapped.lastPressed=a,r.interaction_mapped.gamepadType="keyboard")}}}},{key:"keyboardKeyUp",value:function(t){var e=Object.keys(Phaser.Input.Keyboard.KeyCodes).find(function(e){return Phaser.Input.Keyboard.KeyCodes[e]===t.keyCode}),i=this.getPlayerIndexFromKey(e),n=this.getPlayerButtonFromKey(e);if(-1<i&&""!=n){var r=this.getPlayer(i);if(this.eventEmitter.emit("mergedInput",{device:"keyboard",value:1,player:i,action:e,state:"DOWN"}),r.interaction.device="keyboard",r.interaction.released.push(n),r.interaction.lastReleased=n,void 0!==this.dpadMappings[n]&&(n="B"+this.dpadMappings[n]),void 0!==r.buttons[n]){var a=this.getMappedButton(r,n);void 0!==a&&(r.buttons_mapped[a]=0,r.interaction_mapped.released=a,r.interaction_mapped.lastReleased=a,r.interaction_mapped.gamepadType="keyboard")}}}},{key:"checkPointerInput",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r=this.players[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a=n.value;for(var s in a.keys){var o=!0,d=!1,p=void 0;try{for(var l,u=a.keys[s][Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var y=l.value;["M1","M2","M3","M4","M5"].includes(y[0])&&1==this.players[0].pointer[y]&&(a.buttons[s]=1)}}catch(e){d=!0,p=e}finally{try{!o&&u.return&&u.return()}finally{if(d)throw p}}}}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}}},{key:"gamepadButtonDown",value:function(e,t,i){if(this.players[e.index].interaction.device="gamepad",this.players[e.index].buttons.TIMESTAMP=this.scene.sys.time.now,this.eventEmitter.emit("mergedInput",{device:"gamepad",value:i,player:e.index,action:"B"+t.index,state:"DOWN"}),[12,13,14,15].includes(t.index)){var n=this.dpadMappings,r=Object.keys(n).find(function(e){return n[e]==t.index});this.eventEmitter.emit("mergedInput",{device:"gamepad",value:1,player:e.index,action:r,state:"DOWN"}),this.players[e.index].interaction.pressed.push(r),this.players[e.index].interaction.last=r,this.players[e.index].interaction.lastPressed=r,this.players[e.index].interaction.buffer.push(r),this.players[e.index].direction.TIMESTAMP=this.scene.sys.time.now;var a=this.getMappedButton(this.players[e.index],t.index);void 0!==a&&(this.players[e.index].interaction_mapped.pressed.push(a),this.players[e.index].interaction_mapped.last=a,this.players[e.index].interaction_mapped.lastPressed=a)}else{this.players[e.index].interaction.pressed.push("B"+t.index),this.players[e.index].interaction.last="B"+t.index,this.players[e.index].interaction.lastPressed="B"+t.index,this.players[e.index].interaction.buffer.push("B"+t.index);var s=this.getMappedButton(this.players[e.index],t.index);void 0!==s&&(this.players[e.index].interaction_mapped.pressed.push(s),this.players[e.index].interaction_mapped.last=s,this.players[e.index].interaction_mapped.lastPressed=s)}}},{key:"gamepadButtonUp",value:function(e,t,i){if(this.players[e.index].interaction.device="gamepad",this.players[e.index].buttons.TIMESTAMP=this.scene.sys.time.now,this.eventEmitter.emit("mergedInput",{device:"gamepad",value:i,player:e.index,action:"B"+t.index,state:"UP"}),[12,13,14,15].includes(t.index)){var n=this.dpadMappings,r=Object.keys(n).find(function(e){return n[e]==t.index});this.eventEmitter.emit("mergedInput",{device:"gamepad",value:1,player:e.index,action:r,state:"UP"}),this.players[e.index].interaction.released.push(r),this.players[e.index].interaction.lastReleased=r;var a=this.getMappedButton(this.players[e.index],t.index);void 0!==a&&(this.players[e.index].interaction_mapped.released=a,this.players[e.index].interaction_mapped.lastReleased=a)}else{this.players[e.index].interaction.released.push("B"+t.index),this.players[e.index].interaction.lastReleased="B"+t.index;var s=this.getMappedButton(this.players[e.index],t.index);void 0!==s&&(this.players[e.index].interaction_mapped.released=s,this.players[e.index].interaction_mapped.lastReleased=s)}}},{key:"gamepadFakeDPadPress",value:function(e,t){if(!this.players[e.index].internal.fakedpadBuffer.includes(t)){this.players[e.index].internal.fakedpadBuffer.push(t),this.players[e.index].internal.fakedpadPressed.push(t);var i=new Phaser.Input.Gamepad.Button(e,this.dpadMappings[t]);i.value=1,i.pressed=!0,i.events.emit("down",e,i,1)}}},{key:"gamepadFakeDPadRelease",value:function(e){if(0<this.players[e.index].internal.fakedpadBuffer.length){var t=!0,i=!1,n=void 0;try{for(var r,a=this.players[e.index].internal.fakedpadBuffer[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;this.players[e.index].internal.fakedpadReleased=s;var o=new Phaser.Input.Gamepad.Button(e,this.dpadMappings[s]);o.value=0,o.pressed=!1,o.events.emit("up",e,o,0)}}catch(e){i=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}this.players[e.index].internal.fakedpadBuffer=[]}}},{key:"checkGamepadInput",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r=this.gamepads[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a=n.value;void 0===this.players[a.index]&&this.addPlayer();var s="";if(a.leftStick.y<-.5?(this.players[a.index].direction.UP=Math.abs(a.leftStick.y),this.players[a.index].direction.TIMESTAMP=this.scene.sys.time.now,a.fakedpad&&(this.gamepadFakeDPadPress(a,"UP"),s="UP")):.5<a.leftStick.y?(this.players[a.index].direction.DOWN=a.leftStick.y,this.players[a.index].direction.TIMESTAMP=this.scene.sys.time.now,a.fakedpad&&(this.gamepadFakeDPadPress(a,"DOWN"),s="DOWN")):"gamepad"===this.players[a.index].interaction.device&&(this.players[a.index].direction.UP=a.up?1:0,this.players[a.index].direction.DOWN=a.down?1:0),a.leftStick.x<-.5?(this.players[a.index].direction.LEFT=Math.abs(a.leftStick.x),this.players[a.index].direction.TIMESTAMP=this.scene.sys.time.now,a.fakedpad&&(this.gamepadFakeDPadPress(a,"LEFT"),s="LEFT")):.5<a.leftStick.x?(this.players[a.index].direction.RIGHT=a.leftStick.x,this.players[a.index].direction.TIMESTAMP=this.scene.sys.time.now,a.fakedpad&&(this.gamepadFakeDPadPress(a,"RIGHT"),s="RIGHT")):"gamepad"===this.players[a.index].interaction.device&&(this.players[a.index].direction.LEFT=a.left?1:0,this.players[a.index].direction.RIGHT=a.right?1:0),a.fakedpad&&""==s&&this.gamepadFakeDPadRelease(a),a.rightStick.y<-.5?(this.players[a.index].direction_secondary.UP=Math.abs(a.rightStick.y),this.players[a.index].direction_secondary.TIMESTAMP=this.scene.sys.time.now):.5<a.rightStick.y?(this.players[a.index].direction_secondary.DOWN=a.rightStick.y,this.players[a.index].direction_secondary.TIMESTAMP=this.scene.sys.time.now):(this.players[a.index].direction_secondary.UP=0,this.players[a.index].direction_secondary.DOWN=0),a.rightStick.x<-.5?(this.players[a.index].direction_secondary.LEFT=Math.abs(a.rightStick.x),this.players[a.index].direction_secondary.TIMESTAMP=this.scene.sys.time.now):.5<a.rightStick.x?(this.players[a.index].direction_secondary.RIGHT=a.rightStick.x,this.players[a.index].direction_secondary.TIMESTAMP=this.scene.sys.time.now):(this.players[a.index].direction_secondary.LEFT=0,this.players[a.index].direction_secondary.RIGHT=0),"gamepad"===this.players[a.index].interaction.device)for(var o=0;o<a.buttons.length;o++){var d=a.buttons[o];this.players[a.index].buttons["B"+o]=d.value;var p=this.getMappedButton(this.players[a.index],o);void 0!==p&&(this.players[a.index].buttons_mapped[p]=d.value)}}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}}},{key:"pointerMove",value:function(e,t){if(this.players.length&&(t=t||0,e.distance>t)){var i=this.getBearingFromAngle(e.angle,8);if(void 0!==this.players[0]&&"undefined"!==this.players[0].position.x){var n=this.players[0].position,r=Phaser.Math.Angle.Between(n.x,n.y,e.worldX,e.worldY);i=this.getBearingFromAngle(r,8);var a=Number(this.mapBearingToDegrees(i));this.players[0].pointer.BEARING=i,this.players[0].pointer.ANGLE=r,this.players[0].pointer.BEARING_DEGREES=a,this.players[0].pointer.TIMESTAMP=this.scene.sys.time.now}}}},{key:"pointerDown",value:function(e){if(this.players.length){var t="";this.players[0].interaction.device="pointer",e.leftButtonDown()&&(t="M1"),e.rightButtonDown()&&(t="M2"),e.middleButtonDown()&&(t="M3"),e.backButtonDown()&&(t="M4"),e.forwardButtonDown()&&(t="M5"),this.eventEmitter.emit("mergedInput",{device:"pointer",value:1,player:0,action:t,state:"DOWN"}),this.players[0].pointer[t]=1,this.players[0].interaction.pressed.push(t),this.players[0].interaction.last=t,this.players[0].interaction.lastPressed=t,this.players[0].interaction.buffer.push(t),this.players[0].pointer.TIMESTAMP=e.moveTime}}},{key:"pointerUp",value:function(e){if(this.players.length){var t="";e.leftButtonReleased()&&(t="M1"),e.rightButtonReleased()&&(t="M2"),e.middleButtonReleased()&&(t="M3"),e.backButtonReleased()&&(t="M4"),e.forwardButtonReleased()&&(t="M5"),this.eventEmitter.emit("mergedInput",{device:"pointer",value:1,player:0,action:t,state:"UP"}),this.players[0].pointer[t]=0,this.players[0].interaction.released.push(t),this.players[0].interaction.lastReleased=t,this.players[0].pointer.TIMESTAMP=this.scene.sys.time.now}}},{key:"getBearingFromAngle",value:function(e,t){t=t||8;var i=Phaser.Math.PI2/t,n=Phaser.Math.Snap.To(e,i),r=Phaser.Math.RadToDeg(n);return this.bearings[r]}},{key:"mapBearingToDirections",value:function(e){var t={UP:0,DOWN:0,LEFT:0,RIGHT:0,BEARING:e.toUpperCase()};return e.toUpperCase().includes("W")&&(t.LEFT=1),e.toUpperCase().includes("E")&&(t.RIGHT=1),e.toUpperCase().includes("S")&&(t.DOWN=1),e.toUpperCase().includes("N")&&(t.UP=1),t}},{key:"mapDirectionsToBearing",value:function(e,t){return!e.UP||e.LEFT||e.RIGHT?e.RIGHT&&e.UP?"NE":!e.RIGHT||e.UP||e.DOWN?e.RIGHT&&e.DOWN?"SE":!e.DOWN||e.LEFT||e.RIGHT?e.LEFT&&e.DOWN?"SW":!e.LEFT||e.UP||e.DOWN?e.LEFT&&e.UP?"NW":"":"W":"S":"E":"N"}},{key:"mapBearingToDegrees",value:function(t){var i=this;return""!=t?Object.keys(this.bearings).find(function(e){return i.bearings[e]===t}):""}},{key:"destroy",value:function(){this.shutdown(),this.scene=void 0}},{key:"debug",value:function(){var e={input:{}};e.input.gamepads=[];for(var t=0;t<this.gamepads.length;t++){for(var i=this.gamepads[t],n={},r={},a=0;a<i.buttons.length;a++){var s=i.buttons[a];n["B"+s.index]=s.value}for(var o=0;o<i.axes.length;o++){var d=i.axes[o];r["A"+d.index]=d.getValue()}e.input.gamepads.push({ID:i.id,Index:i.index,Buttons:n,Axes:r})}var p=!0,l=!(e.players=[]),u=void 0;try{for(var y,c=this.players[Symbol.iterator]();!(p=(y=c.next()).done);p=!0){var h,f=y.value;e.players.push((v(h={interaction:f.interaction,interaction_mapped:f.interaction_mapped,buttons:f.buttons,buttons_mapped:f.buttons_mapped},"interaction_mapped",f.interaction_mapped),v(h,"pointer",f.pointer),v(h,"direction",f.direction),v(h,"direction_secondary",f.direction_secondary),v(h,"keys",f.keys),h))}}catch(e){l=!0,u=e}finally{try{!p&&c.return&&c.return()}finally{if(l)throw u}}return e}}]),y);function y(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,e,t));return i.scene=e,i.players=[],i.gamepads=[],i.keys={},i.bearings=s.default,i.dpadMappings={UP:12,DOWN:13,LEFT:14,RIGHT:15},i.controlManager=new o.default,i}t.default=u},function(e,t,i){"use strict";e.exports={"-180":"W","-168.75":"WBN","-157.5":"WNW","-146.25":"NWBW","-135":"NW","-123.75":"NWBN","-112.5":"NNW","-101.25":"NBW","-90":"N","-78.75":"NBE","-67.5":"NNE","-56.25":"NEBN","-45":"NE","-33.75":"NEBE","-22.5":"EBE","-11.25":"EBN",0:"E",11.25:"EBS",22.5:"ESE",33.75:"SEBE",45:"SE",56.25:"SEBS",67.5:"SSE",78.75:"SBE",90:"S",101.25:"SBW",112.5:"SSW",123.75:"SWBS",135:"SW",146.25:"SWBW",157.5:"WSW",168.75:"WBS",180:"W"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e};function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=p(i(3)),s=p(i(4)),o=p(i(5)),d=p(i(6));function p(e){return e&&e.__esModule?e:{default:e}}var l=(n(u,[{key:"mapGamepad",value:function(e){e=e.toLowerCase();var t=a.default;return e.includes("081f")&&e.includes("e401")?t=s.default:e.includes("xbox")&&e.includes("360")?t=o.default:e.includes("054c")&&(t=d.default),t}},{key:"getBaseControls",value:function(){return{direction:{UP:0,DOWN:0,LEFT:0,RIGHT:0,BEARING:"",BEARING_LAST:"",DEGREES:0,DEGREES_LAST:0,TIMESTAMP:0},direction_secondary:{UP:0,DOWN:0,LEFT:0,RIGHT:0,BEARING:"",DEGREES:0,BEARING_LAST:"",DEGREES_LAST:0,TIMESTAMP:0},buttons:{},gamepadMapping:{RC_S:0,RC_E:1,RC_W:2,RC_N:3,START:9,SELECT:8,LB:4,RB:5,LT:6,RT:7,LS:10,RS:11,LC_N:12,LC_S:13,LC_W:14,LC_E:15,MENU:16},pointer:{M1:0,M2:0,M3:0,M4:0,M5:0,BEARING:"",BEARING_DEGREES:0,ANGLE:0,TIMESTAMP:0},position:{x:0,y:0},gamepad:{},keys:{UP:[],DOWN:[],LEFT:[],RIGHT:[]},internal:{fakedpadBuffer:[],fakedpadPressed:[],fakedpadReleased:[]},interaction:{buffer:[],pressed:[],released:[],last:"",lastPressed:"",lastReleased:"",device:""},interaction_mapped:{pressed:[],released:[],last:"",lastPressed:"",lastReleased:"",gamepadType:""},buttons_mapped:{RC_S:0,RC_E:0,RC_W:0,RC_N:0,START:0,SELECT:0,MENU:0,LB:0,RB:0,LT:0,RT:0,LS:0,RS:0,LC_N:0,LC_S:0,LC_W:0,LC_E:0}}}},{key:"setupControls",value:function(e){e=e||16;for(var t=this.getBaseControls(),i=0;i<=e;i++)t.buttons["B"+i]=0,t.keys["B"+i]=[];return t.setPosition=function(e,t){this.position.x=e,this.position.y=t},t}}]),u);function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u)}t.default=l},function(e,t,i){"use strict";e.exports={padID:"Generic",padType:"generic",gamepadMapping:{RC_S:0,RC_E:1,RC_W:2,RC_N:3,START:9,SELECT:8,LB:4,RB:5,LT:6,RT:7,LS:10,RS:11,LC_N:12,LC_S:13,LC_W:14,LC_E:15}}},function(e,t,i){"use strict";e.exports={padID:"081f-e401",padType:"snes",gamepadMapping:{RC_S:2,RC_E:1,RC_W:3,RC_N:0,START:9,SELECT:8,LB:4,RB:5,LC_N:12,LC_S:13,LC_W:14,LC_E:15}}},function(e,t,i){"use strict";e.exports={padID:"Xbox 360 controller (XInput STANDARD GAMEPAD)",padType:"xbox",gamepadMapping:{RC_S:0,RC_E:1,RC_W:2,RC_N:3,START:9,SELECT:8,LB:4,RB:5,LT:6,RT:7,LS:10,RS:11,LC_N:12,LC_S:13,LC_W:14,LC_E:15,MENU:16}}},function(e,t,i){"use strict";e.exports={padID:"Dualshock",padType:"Sony",gamepadMapping:{RC_S:0,RC_E:1,RC_W:2,RC_N:3,START:9,SELECT:8,LB:4,RB:5,LT:6,RT:7,LS:10,RS:11,LC_N:12,LC_S:13,LC_W:14,LC_E:15,MENU:16,TOUCH:17}}}],r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0);function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var i,n});
//# sourceMappingURL=MergedInput.min.map